import{a as Ae}from"./chunk-ENC4N56I.js";import{a as Be}from"./chunk-7QWBADWF.js";import{b as we,d as De,e as Ee,f as T,i as y,k as ke,l as Te,n as Ie,p as Ve,q as Me,r as Oe,s as He,v as ze,w as Ne}from"./chunk-R3LG3Z4T.js";import{a as Ce,b as ye,c as Se,d as Fe,e as Pe}from"./chunk-7MJ2PPIR.js";import{Ia as se,Jb as be,Ma as le,Qa as ce,V as ne,Va as de,Xa as pe,ab as me,bb as _e,cb as ge,d as Y,db as ue,e as X,eb as he,h as Z,ja as re,k as q,ka as ae,na as oe,p as J,pb as ve,qb as fe,r as K,rb as xe,v as ee,w as te,y as ie}from"./chunk-2FO43KNC.js";import{Bc as k,Ca as G,Ec as B,Gb as l,Gc as A,Hb as V,Hc as L,Ib as M,Lc as Q,Rb as r,Sb as a,T as U,Tb as F,Ub as O,Vb as H,Xb as f,ac as u,bb as o,cc as d,gb as b,la as m,ma as _,nc as z,oc as s,pb as W,pc as C,qc as v,rc as P,sc as N,uc as w,vb as g,vc as D,wc as E,x as R,z as j}from"./chunk-JDQTBV46.js";import{a as S}from"./chunk-4CLCTAJ7.js";var $=()=>({standalone:!0});function $e(n,p){n&1&&(r(0,"span",11),s(1,"PRO"),a())}function Re(n,p){if(n&1&&(r(0,"c-card",13)(1,"c-card-header")(2,"strong"),s(3,"Prediction Results"),a()(),r(4,"c-card-body"),F(5,"c-chart",28),a()()),n&2){let e=d(2);o(5),l("data",e.singlePredictionChartData)("options",e.pieChartOptions)}}function je(n,p){n&1&&(r(0,"div",29)(1,"p",24),s(2,"No prediction history available. Make a prediction to see results here."),a()())}function Ue(n,p){if(n&1){let e=f();r(0,"tr",33),u("click",function(){let t=m(e).$implicit,c=d(3);return _(c.showHistoryItemChart(t))}),r(1,"td",34),s(2),a(),r(3,"td"),s(4),a(),r(5,"td"),s(6),a(),r(7,"td"),s(8),B(9,"date"),a()()}if(n&2){let e=p.$implicit,i=d(3);M("selected-history-item",i.isSelectedHistoryItem(e)),o(),l("title",e.text),o(),v(" ",e.text," "),o(2),C(e.result),o(2),v("",e.confidence,"%"),o(2),C(A(9,7,e.timestamp,"short"))}}function Ge(n,p){if(n&1&&(r(0,"div",30)(1,"table",31)(2,"thead")(3,"tr")(4,"th"),s(5,"Text"),a(),r(6,"th"),s(7,"Prediction"),a(),r(8,"th"),s(9,"Confidence"),a(),r(10,"th"),s(11,"Timestamp"),a()()(),r(12,"tbody"),g(13,Ue,10,10,"tr",32),a()()()),n&2){let e=d(2);o(13),l("ngForOf",e.getPaginatedData(e.singlePredictionHistory,e.historyCurrentPage,e.historyPageSize))}}function We(n,p){if(n&1){let e=f();r(0,"c-page-item",40)(1,"a",37),u("click",function(){let t=m(e).$implicit,c=d(3);return _(c.changePage(t,"history"))}),s(2),a()()}if(n&2){let e=p.$implicit,i=d(3);l("active",i.historyCurrentPage===e),o(2),v(" ",e+1," ")}}function Qe(n,p){if(n&1){let e=f();r(0,"c-pagination",35)(1,"c-page-item",36)(2,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(0,"history"))}),s(3,"First"),a()(),r(4,"c-page-item",36)(5,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.historyCurrentPage-1,"history"))}),r(6,"span",38),s(7,"\xAB"),a()()(),g(8,We,3,2,"c-page-item",39),r(9,"c-page-item",36)(10,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.historyCurrentPage+1,"history"))}),r(11,"span",38),s(12,"\xBB"),a()()(),r(13,"c-page-item",36)(14,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.Math.ceil(t.singlePredictionHistory.length/t.historyPageSize)-1,"history"))}),s(15,"Last"),a()()()}if(n&2){let e=d(2);o(),l("disabled",e.historyCurrentPage===0||e.singlePredictionHistory.length<=e.historyPageSize),o(3),l("disabled",e.historyCurrentPage===0||e.singlePredictionHistory.length<=e.historyPageSize),o(4),l("ngForOf",e.getVisiblePageNumbers(e.singlePredictionHistory.length,e.historyPageSize,e.historyCurrentPage)),o(),l("disabled",e.historyCurrentPage>=e.Math.ceil(e.singlePredictionHistory.length/e.historyPageSize)-1||e.singlePredictionHistory.length<=e.historyPageSize),o(4),l("disabled",e.historyCurrentPage>=e.Math.ceil(e.singlePredictionHistory.length/e.historyPageSize)-1||e.singlePredictionHistory.length<=e.historyPageSize)}}function Ye(n,p){if(n&1){let e=f();r(0,"div")(1,"c-row")(2,"c-col",12)(3,"c-card",13)(4,"c-card-header")(5,"strong"),s(6,"Single Line Input"),a()(),r(7,"c-card-body")(8,"form",14)(9,"div",15)(10,"label",16),s(11,"Provide the text to Predict"),a(),F(12,"textarea",17),a(),r(13,"div",18)(14,"button",19),u("click",function(){m(e);let t=d();return _(t.predictSingleText())}),s(15," Predict "),a()()()()(),g(16,Re,6,2,"c-card",20),a(),r(17,"c-col",12)(18,"c-card")(19,"c-card-header")(20,"strong"),s(21,"Prediction History"),a()(),r(22,"c-card-body"),g(23,je,3,0,"div",21)(24,Ge,14,1,"div",22),r(25,"div",23)(26,"div")(27,"small",24),s(28),a()(),g(29,Qe,16,5,"c-pagination",25),r(30,"div")(31,"select",26),E("ngModelChange",function(t){m(e);let c=d();return D(c.historyPageSize,t)||(c.historyPageSize=t),_(t)}),u("change",function(){m(e);let t=d();return _(t.onPageSizeChange("history"))}),r(32,"option",27),s(33,"5 rows"),a(),r(34,"option",27),s(35,"10 rows"),a(),r(36,"option",27),s(37,"25 rows"),a(),r(38,"option",27),s(39,"50 rows"),a()()()()()()()()()}if(n&2){let e=d();o(8),l("formGroup",e.singlePredictionForm),o(6),l("disabled",!e.singlePredictionForm.valid||e.isProcessingSinglePrediction),o(2),l("ngIf",e.lastSinglePrediction),o(7),l("ngIf",e.singlePredictionHistory.length===0),o(),l("ngIf",e.singlePredictionHistory.length>0),o(4),N(" Showing ",e.historyCurrentPage*e.historyPageSize+1," to ",e.Math.min((e.historyCurrentPage+1)*e.historyPageSize,e.singlePredictionHistory.length)," of ",e.singlePredictionHistory.length," predictions "),o(),l("ngIf",e.singlePredictionHistory.length>0),o(2),w("ngModel",e.historyPageSize),l("ngModelOptions",k(15,$)),o(),l("value",5),o(2),l("value",10),o(2),l("value",25),o(2),l("value",50)}}function Xe(n,p){n&1&&(r(0,"div",59),s(1,"PRO"),a())}function Ze(n,p){if(n&1){let e=f();r(0,"button",62),u("click",function(t){m(e);let c=d().$implicit,h=d(2);return _(h.deleteCsvFile(c.id,t))}),s(1," \xD7 "),a()}}function qe(n,p){if(n&1){let e=f();r(0,"c-nav-item")(1,"a",60),u("click",function(){let t=m(e).$implicit,c=d(2);return _(c.selectCsvFile(t.id))}),s(2),g(3,Ze,2,0,"button",61),a()()}if(n&2){let e=p.$implicit,i=d(2);o(),l("active",i.activeCsvFile===e.id),o(),v(" ",e.name," "),o(),l("ngIf",!e.isDefault)}}function Je(n,p){if(n&1&&(r(0,"th"),s(1),a()),n&2){let e=p.$implicit;o(),v(" ",e," ")}}function Ke(n,p){if(n&1&&(O(0),s(1),H()),n&2){let e=d(2).$implicit,i=d().$implicit;o(),v(" ",i[e],"% ")}}function et(n,p){if(n&1&&s(0),n&2){let e=d(2).$implicit,i=d().$implicit;v(" ",i[e]," ")}}function tt(n,p){if(n&1&&(r(0,"td"),g(1,Ke,2,1,"ng-container",66)(2,et,1,1,"ng-template",null,1,L),a()),n&2){let e=z(3),i=d().$implicit;o(),l("ngIf",i==="Confidence")("ngIfElse",e)}}function it(n,p){if(n&1&&(r(0,"span",71),s(1),a()),n&2){let e=p.$implicit,i=d(6);V("background-color",i.getCategoryColor(e.name)),o(),P(" ",e.name,": ",e.value,"% ")}}function nt(n,p){if(n&1&&(r(0,"span",72),s(1),a()),n&2){let e=d(2).$implicit,i=d().$implicit;o(),v(" +",i[e].length-2," more ")}}function rt(n,p){if(n&1){let e=f();r(0,"td")(1,"div",67),g(2,it,2,4,"span",68)(3,nt,2,1,"span",69),a()(),r(4,"td")(5,"span",70),u("click",function(){m(e);let t=d().$implicit,c=d().$implicit,h=d(3);return _(h.showCategoriesModal(c[t]))}),s(6," View Details "),a()()}if(n&2){let e=d().$implicit,i=d().$implicit,t=d(3);o(),l("title",t.formatCategoriesForTooltip(i[e])),o(),l("ngForOf",i[e].slice(0,2)),o(),l("ngIf",i[e].length>2)}}function at(n,p){if(n&1&&(O(0),g(1,tt,4,2,"td",66)(2,rt,7,3,"ng-template",null,0,L),H()),n&2){let e=p.$implicit,i=z(3);o(),l("ngIf",e!=="categories")("ngIfElse",i)}}function ot(n,p){if(n&1&&(r(0,"tr"),g(1,at,4,2,"ng-container",45),a()),n&2){let e=d(3);o(),l("ngForOf",e.getHeaders(e.currentCsvFile.data[0]))}}function st(n,p){if(n&1){let e=f();r(0,"c-page-item",40)(1,"a",37),u("click",function(){let t=m(e).$implicit,c=d(3);return _(c.changePage(t,"bulk"))}),s(2),a()()}if(n&2){let e=p.$implicit,i=d(3);l("active",i.currentPage===e),o(2),v(" ",e+1," ")}}function lt(n,p){if(n&1){let e=f();r(0,"c-card-body")(1,"c-card",13)(2,"c-card-header")(3,"strong"),s(4),a()(),r(5,"c-card-body"),F(6,"c-chart",63),a()(),r(7,"c-card")(8,"c-card-header")(9,"strong"),s(10),a()(),r(11,"c-card-body")(12,"div",64)(13,"table",31)(14,"thead")(15,"tr"),g(16,Je,2,1,"th",45),a()(),r(17,"tbody"),g(18,ot,2,1,"tr",45),a()()(),r(19,"div",23)(20,"div")(21,"small",24),s(22),a()(),r(23,"c-pagination",65)(24,"c-page-item",36)(25,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(0,"bulk"))}),s(26,"First"),a()(),r(27,"c-page-item",36)(28,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.currentPage-1,"bulk"))}),r(29,"span",38),s(30,"\xAB"),a()()(),g(31,st,3,2,"c-page-item",39),r(32,"c-page-item",36)(33,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.currentPage+1,"bulk"))}),r(34,"span",38),s(35,"\xBB"),a()()(),r(36,"c-page-item",36)(37,"a",37),u("click",function(){m(e);let t=d(2);return _(t.changePage(t.Math.ceil(t.currentCsvFile.data.length/t.pageSize)-1,"bulk"))}),s(38,"Last"),a()()(),r(39,"div")(40,"select",26),E("ngModelChange",function(t){m(e);let c=d(2);return D(c.pageSize,t)||(c.pageSize=t),_(t)}),u("change",function(){m(e);let t=d(2);return _(t.onPageSizeChange("bulk"))}),r(41,"option",27),s(42,"10 rows"),a(),r(43,"option",27),s(44,"25 rows"),a(),r(45,"option",27),s(46,"50 rows"),a(),r(47,"option",27),s(48,"100 rows"),a()()()()()()()}if(n&2){let e=d(2);o(4),v("",e.currentCsvFile.name," - Radar Chart"),o(2),l("data",e.currentCsvFile.chartData)("options",e.options),o(4),v("",e.currentCsvFile.name," - Data"),o(6),l("ngForOf",e.getHeaders(e.currentCsvFile.data[0])),o(2),l("ngForOf",e.getPaginatedData(e.currentCsvFile.data,e.currentPage,e.pageSize)),o(4),N(" Showing ",e.currentPage*e.pageSize+1," to ",e.Math.min((e.currentPage+1)*e.pageSize,e.currentCsvFile.data.length)," of ",e.currentCsvFile.data.length," rows "),o(2),l("disabled",e.currentPage===0),o(3),l("disabled",e.currentPage===0),o(4),l("ngForOf",e.getVisiblePageNumbers(e.currentCsvFile.data.length,e.pageSize,e.currentPage)),o(),l("disabled",e.currentPage>=e.Math.ceil(e.currentCsvFile.data.length/e.pageSize)-1),o(4),l("disabled",e.currentPage>=e.Math.ceil(e.currentCsvFile.data.length/e.pageSize)-1),o(4),w("ngModel",e.pageSize),l("ngModelOptions",k(20,$)),o(),l("value",10),o(2),l("value",25),o(2),l("value",50),o(2),l("value",100)}}function ct(n,p){n&1&&(r(0,"c-card-body",29)(1,"p",24),s(2,'No files selected. Please select a file from "My Files".'),a()())}function dt(n,p){if(n&1&&(r(0,"p",73),s(1),a()),n&2){let e,i=d(2);o(),v(" Selected: ",(e=i.fileUploadForm.get("fileName"))==null?null:e.value," ")}}function pt(n,p){n&1&&(r(0,"div",74)(1,"p",75),s(2,"No pending files"),a()())}function mt(n,p){if(n&1&&(r(0,"li",79)(1,"div",80)(2,"span",81),s(3,"Processing..."),a()(),r(4,"span",82),s(5),a(),r(6,"small",83),s(7,"processing..."),a()()),n&2){let e=p.$implicit;o(5),C(e.name)}}function _t(n,p){if(n&1&&(r(0,"div",76)(1,"ul",77),g(2,mt,8,1,"li",78),a()()),n&2){let e=d(2);o(2),l("ngForOf",e.pendingFiles)}}function gt(n,p){if(n&1&&(r(0,"div",84)(1,"small",24),s(2),a()()),n&2){let e=d(2);o(2),v("Showing ",e.pendingFiles.length," files")}}function ut(n,p){if(n&1){let e=f();r(0,"button",85),u("click",function(){m(e);let t=d(2);return _(t.clearFileSearch())}),s(1," \xD7 "),a()}}function ht(n,p){if(n&1&&(r(0,"div",74)(1,"p",75),s(2),a()()),n&2){let e=d(2);o(2),v(" ",e.myFiles.length===0?"No files available":"No matching files"," ")}}function vt(n,p){if(n&1){let e=f();r(0,"li",88),u("click",function(){let t=m(e).$implicit,c=d(3);return _(c.loadFileToVisualization(t.id))}),r(1,"div",89)(2,"span",82),s(3),a(),r(4,"small",83),s(5),B(6,"date"),a()()()}if(n&2){let e=p.$implicit,i=d(3);l("active",i.activeCsvFile===e.id),o(3),C(e.name),o(2),v(" ",A(6,3,e.timestamp,"short")," ")}}function ft(n,p){if(n&1&&(r(0,"div",86)(1,"ul",77),g(2,vt,7,6,"li",87),a()()),n&2){let e=d(2);o(2),l("ngForOf",e.filteredFiles)}}function xt(n,p){if(n&1&&(r(0,"div",84)(1,"small",24),s(2),a()()),n&2){let e=d(2);o(2),P(" Showing ",e.filteredFiles.length," of ",e.myFiles.length," files ")}}function bt(n,p){if(n&1&&(r(0,"div",84)(1,"small",24),s(2),a()()),n&2){let e=d(2);o(2),P(" Found ",e.filteredFiles.length," ",e.filteredFiles.length===1?"match":"matches"," ")}}function Ct(n,p){if(n&1){let e=f();r(0,"div",90)(1,"div",91)(2,"h4"),s(3,"Upgrade to Pro to Access Bulk Prediction"),a(),r(4,"p"),s(5,"Process entire CSV files at once with our premium bulk prediction feature."),a(),r(6,"ul",92)(7,"li"),s(8,"Upload & analyze full datasets"),a(),r(9,"li"),s(10,"Get batch results instantly"),a(),r(11,"li"),s(12,"Export complete result sets"),a(),r(13,"li"),s(14,"Track processing history"),a()(),r(15,"button",93),u("click",function(){m(e);let t=d(2);return _(t.navigateToSubscription())}),s(16," Upgrade to Pro "),a(),r(17,"div",94)(18,"small"),s(19," If the button doesn't work, "),r(20,"a",95),s(21,"click here"),a(),s(22," instead. "),a()()()()}}function yt(n,p){if(n&1){let e=f();r(0,"div",41),g(1,Xe,2,0,"div",42),r(2,"div")(3,"c-row")(4,"c-col",43)(5,"c-card")(6,"c-card-header")(7,"c-nav",44),g(8,qe,4,3,"c-nav-item",45),a()(),g(9,lt,49,21,"c-card-body",7)(10,ct,3,0,"c-card-body",21),a()(),r(11,"c-col",46)(12,"c-card",13)(13,"c-card-header")(14,"strong"),s(15,"Upload CSV File"),a()(),r(16,"c-card-body")(17,"form",14)(18,"div",15)(19,"label",47),s(20,"Choose CSV file"),a(),r(21,"input",48),u("change",function(t){m(e);let c=d();return _(c.onFileSelected(t))}),a(),g(22,dt,2,1,"p",49),a(),r(23,"div",50)(24,"button",19),u("click",function(){m(e);let t=d();return _(t.predictCsvFile())}),s(25," Predict "),a()()()()(),r(26,"c-card",13)(27,"c-card-header")(28,"strong"),s(29,"Pending Files"),a()(),r(30,"c-card-body"),g(31,pt,3,0,"div",51)(32,_t,3,1,"div",52)(33,gt,3,1,"div",53),a()(),r(34,"c-card")(35,"c-card-header")(36,"strong"),s(37,"My Files"),a()(),r(38,"c-card-body")(39,"div",15)(40,"div",54)(41,"input",55),E("ngModelChange",function(t){m(e);let c=d();return D(c.fileSearchQuery,t)||(c.fileSearchQuery=t),_(t)}),u("input",function(){m(e);let t=d();return _(t.filterFiles())}),a(),g(42,ut,2,0,"button",56),a()(),g(43,ht,3,1,"div",51)(44,ft,3,1,"div",57)(45,xt,3,2,"div",53)(46,bt,3,2,"div",53),a()()()()(),g(47,Ct,23,0,"div",58),a()}if(n&2){let e,i,t=d();o(),l("ngIf",!t.hasBulkAccess),o(),M("premium-content-blur",!t.hasBulkAccess),o(6),l("ngForOf",t.csvFiles),o(),l("ngIf",t.currentCsvFile),o(),l("ngIf",!t.currentCsvFile),o(7),l("formGroup",t.fileUploadForm),o(5),l("ngIf",(e=t.fileUploadForm.get("fileName"))==null?null:e.value),o(2),l("disabled",!((i=t.fileUploadForm.get("csvFile"))!=null&&i.value)),o(7),l("ngIf",t.pendingFiles.length===0),o(),l("ngIf",t.pendingFiles.length>0),o(),l("ngIf",t.pendingFiles.length>5),o(8),w("ngModel",t.fileSearchQuery),l("ngModelOptions",k(20,$)),o(),l("ngIf",t.fileSearchQuery),o(),l("ngIf",t.filteredFiles.length===0),o(),l("ngIf",t.filteredFiles.length>0),o(),l("ngIf",!t.fileSearchQuery&&t.myFiles.length>5),o(),l("ngIf",t.fileSearchQuery&&t.filteredFiles.length>0),o(),l("ngIf",!t.hasBulkAccess)}}function St(n,p){if(n&1&&(r(0,"tr")(1,"td")(2,"span",100),s(3),a()(),r(4,"td"),s(5),a()()),n&2){let e=p.$implicit,i=d(2);o(2),V("background-color",i.getCategoryColor(e.name)),o(),v(" ",e.name," "),o(2),v("",e.value,"%")}}function Ft(n,p){if(n&1){let e=f();r(0,"c-card",96)(1,"c-card-header",97)(2,"strong"),s(3,"Category Details"),a(),r(4,"button",98),u("click",function(){m(e);let t=d();return _(t.showCategoryModal=!1)}),s(5," \xD7 "),a()(),r(6,"c-card-body")(7,"table",99)(8,"thead")(9,"tr")(10,"th"),s(11,"Category"),a(),r(12,"th"),s(13,"Confidence"),a()()(),r(14,"tbody"),g(15,St,6,4,"tr",45),a()()()()}if(n&2){let e=d();o(15),l("ngForOf",e.selectedCategories)}}function Pt(n,p){if(n&1){let e=f();r(0,"div",101),u("click",function(){m(e);let t=d();return _(t.showCategoryModal=!1)}),a()}}var Gt=(()=>{class n{constructor(e,i,t,c,h,x){this.http=e,this.predictionService=i,this.subscriptionService=t,this.cdr=c,this.route=h,this.router=x,this._cachedChartData=null,this._lastPredictionTimeStamp=null,this.selectedHistoryItem=null,this.statusCheckSubscription=null,this.fileStatusSubscriptions=new Map,this.activeTab="single",this.activeCsvFile="",this.mainChart={type:"line"},this.mainChartRef=G(void 0),this.chart=[],this.fileSearchQuery="",this.filteredFiles=[],this.pageSize=10,this.currentPage=0,this.Math=Math,this.isProcessingSinglePrediction=!1,this.historyPageSize=5,this.historyCurrentPage=0,this.selectedCategories=[],this.showCategoryModal=!1,this.lastSinglePrediction=null,this.singlePredictionHistory=[],this.pieChartOptions={maintainAspectRatio:!1,plugins:{legend:{position:"right"}}},this.options={maintainAspectRatio:!1},this.pendingFiles=[],this.myFiles=[],this.singlePredictionForm=new T({textInput:new y("",{nonNullable:!0})}),this.predictionForm=new T({text:new y("",{nonNullable:!0})}),this.isPredicting=!1,this.fileUploadForm=new T({csvFile:new y(null),fileName:new y("")}),this.csvFiles=[{id:"csv1",name:"Sample Data 1",isDefault:!1,data:[{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95},{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95},{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95},{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95},{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95},{class:"A",value1:85,value2:92},{class:"B",value1:72,value2:68},{class:"C",value1:90,value2:95}],status:"completed",timestamp:new Date,chartData:{labels:["A","B","C"],datasets:[{label:"Sample Dataset 1",backgroundColor:"rgba(179,181,198,0.2)",borderColor:"rgba(179,181,198,1)",pointBackgroundColor:"rgba(179,181,198,1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(179,181,198,1)",data:[85,72,90]}]}},{id:"csv2",name:"Sample Data 2",isDefault:!1,data:[{class:"X",value1:65,value2:79},{class:"Y",value1:88,value2:91},{class:"Z",value1:76,value2:82}],status:"completed",timestamp:new Date,chartData:{labels:["X","Y","Z"],datasets:[{label:"Sample Dataset 2",backgroundColor:"rgba(255,99,132,0.2)",borderColor:"rgba(255,99,132,1)",pointBackgroundColor:"rgba(255,99,132,1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(255,99,132,1)",data:[65,88,76]}]}}],this.chartRadarData={labels:["Eating","Drinking","Sleeping","Designing","Coding","Cycling","Running"],datasets:[{label:"2020",backgroundColor:"rgba(179,181,198,0.2)",borderColor:"rgba(179,181,198,1)",pointBackgroundColor:"rgba(179,181,198,1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(179,181,198,1)",data:[65,59,90,81,56,55,40]}]}}get totalPages(){return this.currentCsvFile?Math.ceil(this.currentCsvFile.data.length/this.pageSize):0}ngOnInit(){this.route.data.subscribe(e=>{e.activeTab&&(this.activeTab=e.activeTab,console.log("Active tab from route data:",this.activeTab))}),this.router.events.pipe(j(e=>e instanceof ee)).subscribe(()=>{let e=this.router.url;e.includes("/dashboard/bulk")?this.activeTab="bulk":e.includes("/dashboard/single")&&(this.activeTab="single"),this.cdr.detectChanges()}),this.predictionService.getUserData().subscribe({next:e=>{this.singlePredictionHistory=e.predictionHistory,this.pendingFiles=e.pendingFiles,this.myFiles=e.completedFiles,this.filteredFiles=this.myFiles,this.csvFiles.length>0&&(this.activeCsvFile=this.csvFiles[0].id),this.singlePredictionHistory.length>0&&(this.lastSinglePrediction=S({},this.singlePredictionHistory[0]),this.selectedHistoryItem=this.singlePredictionHistory[0])},error:e=>{console.error("Error loading user data:",e),this.csvFiles=ye,this.singlePredictionHistory=Ce,this.pendingFiles=Se,this.myFiles=Fe,this.filteredFiles=this.myFiles,this.singlePredictionHistory.length>0&&(this.lastSinglePrediction=S({},this.singlePredictionHistory[0]),this.selectedHistoryItem=this.singlePredictionHistory[0])}})}showHistoryItemChart(e){this.selectedHistoryItem=e,this.lastSinglePrediction={text:e.text,result:e.result,confidence:e.confidence,categories:e.categories,timestamp:e.timestamp},this._cachedChartData=null}isSelectedHistoryItem(e){return this.selectedHistoryItem&&this.selectedHistoryItem.timestamp===e.timestamp}filterFiles(){if(!this.fileSearchQuery){this.filteredFiles=this.myFiles;return}let e=this.fileSearchQuery.toLowerCase();this.filteredFiles=this.myFiles.filter(i=>i.name.toLowerCase().includes(e))}clearFileSearch(){this.fileSearchQuery="",this.filterFiles()}selectCsvFile(e){this.activeCsvFile=e,this.currentPage=0}get currentCsvFile(){return this.csvFiles.find(e=>e.id===this.activeCsvFile)}predictSingleText(){let e=this.singlePredictionForm.get("textInput")?.value;e&&(this.isProcessingSinglePrediction=!0,this.predictionService.predictText(e).subscribe({next:i=>{let t=Object.entries(i.sentiment_scores).map(([h,x])=>({name:h==="neutral"?"Neutral":h,value:Number((x*100).toFixed(2))})),c={text:e,result:i.final_prediction,confidence:Number((i.sentiment_scores[i.final_prediction]*100).toFixed(2)),categories:t,timestamp:new Date,rawResponse:i};this.predictionService.savePredictionToHistory(c),this.predictionService.getUserData().subscribe(h=>{this.singlePredictionHistory=h.predictionHistory,this.lastSinglePrediction=S({},c),this.selectedHistoryItem=this.singlePredictionHistory[0],this.historyCurrentPage=0,this._cachedChartData=null,this.singlePredictionForm.reset(),this.isProcessingSinglePrediction=!1})},error:i=>{console.error("[DEBUG] Error in predictSingleText:",i),this.isProcessingSinglePrediction=!1,alert("Failed to process prediction. Please try again.")}}))}getHeaders(e){return e?Object.keys(e):[]}deleteCsvFile(e,i){i.stopPropagation();let t=this.csvFiles.findIndex(c=>c.id===e);t!==-1&&(this.csvFiles.splice(t,1),e===this.activeCsvFile&&this.csvFiles.length>0?this.activeCsvFile=this.csvFiles[0].id:this.csvFiles.length===0&&(this.activeCsvFile=""))}onFileSelected(e){let i=e.target,t=i?.files?.[0];i.value="",t&&this.fileUploadForm.patchValue({fileName:t.name,csvFile:t})}predictCsvFile(){let e=this.fileUploadForm.get("csvFile")?.value;if(!e){alert("Please select a file first");return}this.predictionService.uploadCsvForPrediction(e).subscribe({next:i=>{if(!i){alert("Failed to upload file. Please try again.");return}this.pendingFiles.findIndex(c=>c.id===i.fileId)===-1&&this.pendingFiles.push({id:i.fileId,name:i.name||e.name,timestamp:new Date(i.timestamp)||new Date}),this.fileUploadForm.reset(),this.pollFileStatus(i.fileId)},error:i=>{console.error("Error uploading file:",i),alert("Failed to upload file. Please try again.")}})}loadFileToVisualization(e){if(this.csvFiles.findIndex(t=>t.id===e)!==-1){this.activeCsvFile=e;return}this.predictionService.getFileDetails(e).subscribe({next:t=>{let c=this.generateChartDataFromApiResponse(t),h={id:e,name:t.name,status:"completed",timestamp:new Date(t.timestamp),isDefault:!1,data:t.data||[],chartData:c};this.csvFiles.push(h),this.activeCsvFile=e},error:t=>{console.error("Error loading file details:",t),alert("Failed to load file details. Please try again.")}})}get singlePredictionChartData(){if(!this.lastSinglePrediction)return{labels:[],datasets:[{data:[],backgroundColor:[]}]};if(this._cachedChartData&&this._lastPredictionTimeStamp===this.lastSinglePrediction.timestamp)return this._cachedChartData;let e={labels:this.lastSinglePrediction.categories.map(i=>i.name),datasets:[{data:this.lastSinglePrediction.categories.map(i=>i.value),backgroundColor:["rgba(25, 135, 84, 0.8)","rgba(13, 202, 240, 0.8)","rgba(108, 117, 125, 0.8)","rgba(255, 193, 7, 0.8)","rgba(220, 53, 69, 0.8)"],borderWidth:1}]};return this._cachedChartData=e,this._lastPredictionTimeStamp=this.lastSinglePrediction.timestamp,e}getPaginatedData(e,i,t){if(!e||!e.length)return[];let c=i*t,h=c+t;return e.slice(c,h)}getVisiblePageNumbers(e,i,t){let c=Math.ceil(e/i),h=[];if(c<=7)for(let x=0;x<c;x++)h.push(x);else{h.push(0),t>2&&h.push(-1);let x=Math.max(1,t-1),Le=Math.min(c-2,t+1);for(let I=x;I<=Le;I++)h.push(I);t<c-3&&h.push(-1),c>1&&h.push(c-1)}return h}changePage(e,i){if(i==="bulk"){let t=this.currentCsvFile?Math.ceil(this.currentCsvFile.data.length/this.pageSize):0;e>=0&&e<t&&(this.currentPage=e)}else{let t=Math.ceil(this.singlePredictionHistory.length/this.historyPageSize);e>=0&&e<t&&(this.historyCurrentPage=e)}}onPageSizeChange(e){e==="bulk"?this.currentPage=0:this.historyCurrentPage=0}formatCategoriesForTooltip(e){return!e||!Array.isArray(e)?"No categories":e.map(i=>`${i.name}: ${i.value}%`).join(`
`)}getCategoryColor(e){return{"Very Negative":"rgba(220, 53, 69, 0.8)","Slightly Negative":"rgba(255, 193, 7, 0.8)",Neutral:"rgba(108, 117, 125, 0.8)","Slightly Positive":"rgba(13, 202, 240, 0.8)","Very Positive":"rgba(25, 135, 84, 0.8)"}[e]||"gray"}showCategoriesModal(e){this.selectedCategories=e,this.showCategoryModal=!0,console.log("Categories:",e),setTimeout(()=>{this.showCategoryModal=!1},3e3)}pollFileStatus(e){this.fileStatusSubscriptions.has(e)&&this.fileStatusSubscriptions.get(e)?.unsubscribe();let i=!1,t=R(2e3).pipe(U(()=>!i)).subscribe({next:()=>{this.predictionService.checkFileStatus(e).subscribe({next:c=>{c.status==="completed"?(i=!0,this.pendingFiles=this.pendingFiles.filter(h=>h.id!==e),this.refreshFilesList(),this.fileStatusSubscriptions.has(e)&&(this.fileStatusSubscriptions.get(e)?.unsubscribe(),this.fileStatusSubscriptions.delete(e))):c.status==="error"&&(i=!0,this.pendingFiles=this.pendingFiles.filter(h=>h.id!==e),alert(`Processing of file failed: ${c.message||"Unknown error"}`),this.fileStatusSubscriptions.has(e)&&(this.fileStatusSubscriptions.get(e)?.unsubscribe(),this.fileStatusSubscriptions.delete(e)))},error:c=>{console.error("Error checking file status:",c),i=!0,this.fileStatusSubscriptions.has(e)&&(this.fileStatusSubscriptions.get(e)?.unsubscribe(),this.fileStatusSubscriptions.delete(e))}})}});this.fileStatusSubscriptions.set(e,t)}refreshFilesList(){this.predictionService.getFiles().subscribe({next:e=>{if(!e){console.error("Received null response from getFiles()");return}let i=new Set(this.pendingFiles.map(t=>t.id));if(e.pendingFiles&&Array.isArray(e.pendingFiles)){e.pendingFiles.forEach(c=>{i.has(c.id)||this.pendingFiles.push({id:c.id,name:c.name,timestamp:new Date(c.timestamp)})});let t=new Set(e.pendingFiles.map(c=>c.id));this.pendingFiles=this.pendingFiles.filter(c=>t.has(c.id))}e.completedFiles&&Array.isArray(e.completedFiles)&&(this.myFiles=e.completedFiles.map(t=>({id:t.id,name:t.name,status:"completed",timestamp:new Date(t.timestamp),isDefault:!1,data:[],chartData:void 0}))),this.filterFiles(),this.cdr.detectChanges()},error:e=>{console.error("Error fetching files:",e),this.cdr.detectChanges()}})}generateChartDataFromApiResponse(e){if(!e||!e.data)return{labels:[],datasets:[{label:"No Data Available",backgroundColor:[],borderColor:"rgba(179,181,198,1)",data:[]}]};let i={"Very Positive":0,"Slightly Positive":0,Neutral:0,"Slightly Negative":0,"Very Negative":0};return Array.isArray(e.data)&&e.data.forEach(t=>{let c=t?.Prediction;c&&Object.prototype.hasOwnProperty.call(i,c)&&i[c]++}),{labels:Object.keys(i),datasets:[{label:"Sentiment Distribution",backgroundColor:["rgba(25, 135, 84, 0.8)","rgba(13, 202, 240, 0.8)","rgba(108, 117, 125, 0.8)","rgba(255, 193, 7, 0.8)","rgba(220, 53, 69, 0.8)"],borderColor:"rgba(179,181,198,1)",data:Object.values(i)}]}}ngOnDestroy(){this.fileStatusSubscriptions.forEach(e=>e.unsubscribe()),this.fileStatusSubscriptions.clear()}navigateToTab(e){this.router.navigate(["/dashboard",e])}navigateToSubscription(){console.log("Navigating to subscription page..."),this.router.navigate(["/subscription"]).then(e=>{console.log("Navigation success:",e),e||(console.error("Navigation failed, trying window.location"),window.location.href="/subscription")}).catch(e=>{console.error("Navigation error:",e)})}get hasBulkAccess(){return this.subscriptionService.hasBulkAccess()}switchTab(e){this.activeTab=e,this.router.navigate(["/dashboard",e],{skipLocationChange:!1,replaceUrl:!1})}static{this.\u0275fac=function(i){return new(i||n)(b(J),b(Pe),b(Ae),b(Q),b(te),b(ie))}}static{this.\u0275cmp=W({type:n,selectors:[["app-dashboard"]],decls:18,vars:7,consts:[["categoriesCell",""],["regularContent",""],[1,"dashboard-container"],[1,"mx-auto",2,"max-width","90%","width","90%"],["layout","justified","variant","pills"],["cNavLink","",2,"cursor","pointer",3,"click","active"],["class","badge bg-secondary ms-1",4,"ngIf"],[4,"ngIf"],["class","premium-content-container",4,"ngIf"],["class","position-fixed","style","top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1050; max-width: 500px;",4,"ngIf"],["class","position-fixed top-0 start-0 w-100 h-100","style","background-color: rgba(0,0,0,0.5); z-index: 1040;",3,"click",4,"ngIf"],[1,"badge","bg-secondary","ms-1"],["xs","12","md","6"],[1,"mb-4"],["cForm","",3,"formGroup"],[1,"mb-3"],["cLabel","","for","exampleFormControlTextarea1"],["cFormControl","","id","exampleFormControlTextarea1","rows","3","formControlName","textInput"],[1,"d-flex","justify-content-end"],["cButton","","color","primary","type","button",3,"click","disabled"],["class","mb-4",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","table-responsive","style","max-height: 600px; overflow-y: auto;",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"text-muted"],["aria-label","History pages","size","sm",4,"ngIf"],["cSelect","","size","sm",2,"width","auto",3,"ngModelChange","change","ngModel","ngModelOptions"],[3,"value"],["type","pie",3,"data","options"],[1,"text-center","py-5"],[1,"table-responsive",2,"max-height","600px","overflow-y","auto"],["cTable","","hover",""],["style","cursor: pointer;",3,"selected-history-item","click",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click"],[2,"max-width","200px","white-space","nowrap","overflow","hidden","text-overflow","ellipsis",3,"title"],["aria-label","History pages","size","sm"],[3,"disabled"],["cPageLink","",2,"cursor","pointer",3,"click"],["aria-hidden","true"],[3,"active",4,"ngFor","ngForOf"],[3,"active"],[1,"premium-content-container"],["class","premium-tag",4,"ngIf"],["md","8"],["variant","tabs"],[4,"ngFor","ngForOf"],["md","4"],["cLabel","","for","formFile"],["cFormControl","","type","file","id","formFile","accept",".csv",3,"change"],["class","mt-2 mb-0",4,"ngIf"],[1,"d-grid"],["class","text-center py-3",4,"ngIf"],["style","max-height: 200px; overflow-y: auto;",4,"ngIf"],["class","text-end mt-2",4,"ngIf"],[1,"input-group"],["cFormControl","","type","text","placeholder","Search files...",3,"ngModelChange","input","ngModel","ngModelOptions"],["cButton","","color","secondary","variant","outline","type","button",3,"click",4,"ngIf"],["style","max-height: 240px; overflow-y: auto;",4,"ngIf"],["class","premium-overlay",4,"ngIf"],[1,"premium-tag"],["cNavLink","",1,"d-flex","align-items-center",3,"click","active"],["cButton","","color","danger","size","sm","variant","ghost","class","ms-2 p-0 px-1","style","line-height: 1;",3,"click",4,"ngIf"],["cButton","","color","danger","size","sm","variant","ghost",1,"ms-2","p-0","px-1",2,"line-height","1",3,"click"],["type","radar",3,"data","options"],[1,"table-responsive",2,"max-height","450px","overflow-y","auto"],["aria-label","Data table pages","size","sm"],[4,"ngIf","ngIfElse"],[1,"categories-summary",3,"title"],["class","badge","style","margin-right: 3px; font-size: 0.7rem;",3,"background-color",4,"ngFor","ngForOf"],["style","font-size: 0.7rem;",4,"ngIf"],[1,"badge","rounded-pill","bg-primary",2,"cursor","pointer",3,"click"],[1,"badge",2,"margin-right","3px","font-size","0.7rem"],[2,"font-size","0.7rem"],[1,"mt-2","mb-0"],[1,"text-center","py-3"],[1,"text-muted","mb-0"],[2,"max-height","200px","overflow-y","auto"],["cListGroup",""],["cListGroupItem","","class","d-flex align-items-center",4,"ngFor","ngForOf"],["cListGroupItem","",1,"d-flex","align-items-center"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","me-2"],[1,"visually-hidden"],[1,"text-truncate"],[1,"text-muted","ms-auto"],[1,"text-end","mt-2"],["cButton","","color","secondary","variant","outline","type","button",3,"click"],[2,"max-height","240px","overflow-y","auto"],["cListGroupItem","","style","cursor: pointer;",3,"active","click",4,"ngFor","ngForOf"],["cListGroupItem","",2,"cursor","pointer",3,"click","active"],[1,"d-flex","align-items-center"],[1,"premium-overlay"],[1,"premium-message"],[1,"text-start","mb-4"],["cButton","","color","primary","size","lg",1,"px-4",3,"click"],[1,"mt-3"],["href","/subscription"],[1,"position-fixed",2,"top","50%","left","50%","transform","translate(-50%, -50%)","z-index","1050","max-width","500px"],[1,"d-flex","justify-content-between","align-items-center"],["cButton","","color","secondary","variant","ghost","size","sm",3,"click"],["cTable","","striped",""],[1,"badge"],[1,"position-fixed","top-0","start-0","w-100","h-100",2,"background-color","rgba(0,0,0,0.5)","z-index","1040",3,"click"]],template:function(i,t){i&1&&(r(0,"div",2)(1,"c-card",3)(2,"c-card-body")(3,"c-card")(4,"c-card-header")(5,"c-nav",4)(6,"c-nav-item")(7,"a",5),u("click",function(){return t.switchTab("single")}),s(8," Single Line Prediction "),a()(),r(9,"c-nav-item")(10,"a",5),u("click",function(){return t.switchTab("bulk")}),s(11," Bulk Prediction "),g(12,$e,2,0,"span",6),a()()()(),r(13,"c-card-body"),g(14,Ye,40,16,"div",7)(15,yt,48,21,"div",8),a()()()(),g(16,Ft,16,1,"c-card",9)(17,Pt,1,0,"div",10),a()),i&2&&(o(7),l("active",t.activeTab==="single"),o(3),l("active",t.activeTab==="bulk"),o(2),l("ngIf",!t.hasBulkAccess),o(2),l("ngIf",t.activeTab==="single"),o(),l("ngIf",t.activeTab==="bulk"),o(),l("ngIf",t.showCategoryModal),o(),l("ngIf",t.showCategoryModal))},dependencies:[q,Y,X,Z,xe,fe,ve,K,he,ue,ge,re,ae,Ne,Te,Oe,He,we,Me,De,Ee,Ie,Ve,Be,oe,be,pe,de,me,_e,ze,ke,se,le,ce,ne],styles:["[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:x-small}.dashboard-container[_ngcontent-%COMP%]{width:95%;margin:0 auto;padding:1rem}.dashboard-container[_ngcontent-%COMP%]   c-card[_ngcontent-%COMP%]{width:100%}c-card-body[_ngcontent-%COMP%]{width:100%}c-chart[_ngcontent-%COMP%]{display:block;width:100%;min-height:300px}.categories-summary[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:150px;cursor:help}.categories-summary[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{display:inline-block;padding:.25em .4em;border-radius:.25rem;color:#fff;text-align:center;white-space:nowrap;vertical-align:baseline}[title][_ngcontent-%COMP%]{position:relative}[title][_ngcontent-%COMP%]:hover:after{content:attr(title);position:absolute;bottom:100%;left:0;background:#000c;color:#fff;padding:5px 10px;border-radius:4px;font-size:.75rem;z-index:100;white-space:pre;min-width:150px}.premium-content-container[_ngcontent-%COMP%]{position:relative;width:100%}.premium-content-blur[_ngcontent-%COMP%]{filter:blur(2px);pointer-events:none;-webkit-user-select:none;user-select:none;opacity:.7}.premium-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:10;background:#0003;border-radius:5px}.premium-message[_ngcontent-%COMP%]{background-color:#fffffff2;padding:20px;border-radius:8px;text-align:center;box-shadow:0 4px 15px #00000026;max-width:90%;width:450px}.premium-tag[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;background-color:#f0ad4e;color:#fff;padding:5px 15px;border-radius:20px;font-weight:700;box-shadow:0 2px 5px #0003;z-index:11}"]})}}return n})();export{Gt as DashboardComponent};
